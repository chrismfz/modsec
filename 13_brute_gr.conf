# ---------------------------------------------------------------
# Core ModSecurity Rule Set for Greek CMSes Brute Force Attacks
# Copyright (C) 2016 MyIP net-Works All rights reserved.
#
# This ModSecurity Rules is distributed under 
# Apache Software License (ASL) version 2
# Please see the enclosed LICENCE file for full details.
# ---------------------------------------------------------------

# ModSecurity rules for brute force attacks for common CMSes
# For Greek Translations

# TODO:


#Έχετε καθορίσει έναν άκυρο κωδικό πρόσβασης.
#Παρακαλώ ελέγξτε τον κωδικό πρόσβασης και προσπαθήστε
#Το πεδίο Ερώτηση ασφαλείας είναι απαραίτητο (drupal and captcha )
#Δυστυχώς, το όνομα λογαριασμού ή το συνθηματικό εισόδου δεν αναγνωρίζεται ( drupal)
# <div id="login_error">	<strong>ΣΦΑΛΜΑ</strong>  wordpress

# Joomla 1.x / 2.x / 3.x various greek translations
SecRule RESPONSE_BODY "Το όνομα χρήστη και ο κωδικός πρόσβασης δεν ταιριάζουν" \
        "phase:4,t:none,nolog,auditlog,ctl:auditLogParts=+E,pass,msg:'Login Failure Detection: Joomla Administration Login Attempt Failure ',id:'990001',rev:5,severity:'4',tag:'no_ar'"

SecRule RESPONSE_BODY "Αποτυχία ταυτοποίησης" \
        "phase:4,t:none,nolog,auditlog,ctl:auditLogParts=+E,pass,msg:'Login Failure Detection: Joomla Administration Login Attempt Failure ',id:'990002',rev:5,severity:'4',tag:'no_ar'"


SecRule RESPONSE_BODY "Εσφαλμένο όνομα χρήστη ή κωδικός" \
        "phase:4,t:none,nolog,auditlog,ctl:auditLogParts=+E,pass,msg:'Login Failure Detection: Joomla Administration Login Attempt Failure ',id:'990003',rev:5,severity:'4',tag:'no_ar'"


SecRule RESPONSE_BODY "Δεν υπάρχει αντιστοίχηση μεταξύ του ονόματος χρήστη και του κωδικού ή δεν έχετε ακόμη δημιουργήσει λογαριασμό" \
        "phase:4,t:none,nolog,auditlog,ctl:auditLogParts=+E,pass,msg:'Login Failure Detection: Joomla Administration Login Attempt Failure ',id:'990004',rev:5,severity:'4',tag:'no_ar'"






#phpbb login failure
SecRule RESPONSE_BODY ">The visual confirmation code you submitted was incorrect</span>" \
        "phase:4,t:none,nolog,auditlog,ctl:auditLogParts=+E,pass,msg:'Login Failure Detection: Recaptcha invalid code',id:'99377410',rev:1,severity:'4',tag:'no_ar'"


#phpbb login failure
SecRule RESPONSE_BODY "You have entered an invalid username or password\. Please enter the correct details and" \
        "phase:4,t:none,nolog,auditlog,ctl:auditLogParts=+E,pass,msg:'Login Failure Detection: VBulletin Login Attempt Failure ',id:'99377300',rev:1,severity:'4',tag:'no_ar'"


#phpbb login failure
#You have specified an incorrect password. Please check your password and try again.
SecRule RESPONSE_BODY "You have specified an incorrect password\. Please check your password and try again\."  \
        "phase:4,t:none,nolog,auditlog,ctl:auditLogParts=+E,pass,msg:'Login Failure Detection: PHPBB Login Attempt Failure ',id:'99377301',rev:1,severity:'4',tag:'no_ar'"




		
#wordpress
#<div id="login_error">	<strong>ERROR</strong>: The password you entered for the username <strong>admin</strong> is incorrect. <a href="http://server2/wordpress/wp-login.php?action=lostpassword" title="Password Lost and Found">Lost your password</a>?<br />
SecRule RESPONSE_BODY "<strong>E(?:rror|RROR)</strong>\: The password you entered for the username" \
        "phase:4,t:none,nolog,auditlog,ctl:auditLogParts=+E,pass,msg:'Login Failure Detection: WordPress Login Attempt Failure ',id:'99377305',rev:2,severity:'4',tag:'no_ar'"

#Newer versions of WP
SecRule RESPONSE_BODY "<strong>E(?:rror|RROR)</strong>\: Incorrect password" \
        "phase:4,t:none,nolog,auditlog,ctl:auditLogParts=+E,pass,msg:'Login Failure Detection: WordPress Login Attempt Failure ',id:'99377605',rev:2,severity:'4',tag:'no_ar'"

#Multiple WP xmlrpc brute force
SecRule RESPONSE_BODY|XML:/* "faultString.{,32}Incorrect username or password.{,100}faultString.{,32}Incorrect username or password.{,100}faultString.{,32}Incorrect username or password" \
        "phase:4,t:none,nolog,auditlog,ctl:auditLogParts=+E,deny,status:403,msg:'Login Failure Detection: WordPress Multiple Simultaneous Login Attempt Failure ',id:'99377679',rev:2,severity:'2'"

SecRule RESPONSE_BODY|XML:/* "isAdmin.{,100}boolean.{,100}isAdmin.{,100}boolean.{,100}isAdmin.{,100}boolean" \
        "phase:4,t:none,nolog,auditlog,ctl:auditLogParts=+E,deny,status:403,msg:'Login Failure Detection: WordPress Multiple Simultaneous Login Attempt Failure ',id:'99377689',rev:2,severity:'2'"

#Newer versions of WP XMLRPC API
SecRule RESPONSE_BODY|XML:/* "(?:<string>|faultString.{,128})Incorrect username or password" \
        "phase:4,t:none,nolog,auditlog,ctl:auditLogParts=+E,pass,msg:'Login Failure Detection: WordPress Login Attempt Failure ',id:'99377625',rev:3,severity:'4',tag:'no_ar'"
#Newer versions of WP XMLRPC API
SecRule RESPONSE_BODY "<string>server error. requested method wp\." \
        "phase:4,t:none,nolog,auditlog,ctl:auditLogParts=+E,pass,msg:'wisez gr brute forceRules: Potential WordPress Method Probe Detected ',id:'99377626',rev:3,severity:'4',tag:'no_ar'"



#wordpress
#<div id="login_error">	<strong>ERROR</strong>: Invalid username. <a href="http://server2/wordpress/wp-login.php?action=lostpassword" title="Password Lost and Found">Lost your password</a>?<br />
SecRule RESPONSE_BODY "<strong>E(?:rror|RROR)</strong>: Invalid username" \
        "phase:4,t:none,nolog,auditlog,ctl:auditLogParts=+E,pass,msg:'Login Failure Detection: Wordpress invalid username failure ',id:'99377306',rev:1,severity:'4',tag:'no_ar'"

#Drupal
SecRule RESPONSE_BODY "Sorry, unrecognized username or password" \
        "phase:4,t:none,nolog,auditlog,ctl:auditLogParts=+E,pass,msg:'Login Failure Detection: Drupal invalid username or password failure ',id:'99377308',rev:2,severity:'4',tag:'no_ar'"




# prestashop  blank password
# 		<ol style="margin: 0 0 0 20px;"><li>Password is blank</li>

SecRule RESPONSE_BODY "<li>Password is blank</li>" \
        "phase:4,t:none,nolog,auditlog,ctl:auditLogParts=+E,pass,msg:'Login Failure Detection: Prestashop login failure (blank password)',id:'99377322',rev:1,severity:'4',tag:'no_ar'"


#phpbb login failure
#You have specified an incorrect password. Please check your password and try again.
SecRule RESPONSE_BODY "You have specified an incorrect username\. Please check your username and try again\."  \
        "phase:4,t:none,nolog,auditlog,ctl:auditLogParts=+E,pass,msg:'Login Failure Detection: PHPBB Login Attempt Failure - Incorrect Username ',id:'99377326',rev:1,severity:'4',tag:'no_ar'"


SecMarker END_BRUTE_OUT_1


SecMarker END_BRUTE_OUT
